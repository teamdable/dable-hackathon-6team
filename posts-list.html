<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Î™®Îì† Í≥µÏó∞ - StageX</title>
    <link rel="stylesheet" href="css/style.css">
    <style>
        .posts-list-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 60px 20px;
        }

        .posts-list-header {
            margin-bottom: 40px;
        }

        .posts-list-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #1a1a1a;
        }

        .posts-list-subtitle {
            font-size: 1.1rem;
            color: #666;
        }

        .posts-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin-bottom: 60px;
        }

        .post-card {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
        }

        .post-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 4px 16px rgba(0,0,0,0.15);
        }

        .post-card-image {
            width: 100%;
            height: 200px;
            overflow: hidden;
        }

        .post-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .post-card-content {
            padding: 20px;
        }

        .post-card-category {
            display: inline-block;
            padding: 4px 12px;
            background: #ff4444;
            color: white;
            border-radius: 4px;
            font-size: 0.85rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .post-card-title {
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 10px;
            color: #1a1a1a;
            line-height: 1.4;
        }

        .post-card-excerpt {
            font-size: 0.95rem;
            color: #666;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .post-card-meta {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 0.9rem;
            color: #999;
        }

        .post-card-date {
            font-weight: 500;
        }

        .post-card-venue {
            font-style: italic;
        }

        .filter-section {
            margin-bottom: 30px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 20px;
            border: 2px solid #ddd;
            background: white;
            border-radius: 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-weight: 600;
        }

        .filter-btn:hover {
            border-color: #ff4444;
            color: #ff4444;
        }

        .filter-btn.active {
            background: #ff4444;
            color: white;
            border-color: #ff4444;
        }

        .no-posts {
            text-align: center;
            padding: 60px 20px;
            color: #999;
            font-size: 1.1rem;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container">
            <div class="nav-wrapper">
                <a href="index.html" class="logo">
                    <img src="images/logo/stagex.png" alt="StageX" class="logo-icon">
                    <span class="logo-text">StageX</span>
                </a>
                <nav class="nav">
                    <button class="search-btn" aria-label="Search">üîç</button>
                </nav>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="posts-list-container">
            <div class="posts-list-header">
                <h1 class="posts-list-title">Î™®Îì† Í≥µÏó∞</h1>
                <p class="posts-list-subtitle">ÏµúÏã† Í≥µÏó∞ Ï†ïÎ≥¥Î•º ÌôïÏù∏ÌïòÏÑ∏Ïöî</p>
            </div>

            <!-- Filter Section -->
            <div class="filter-section">
                <button class="filter-btn active" data-category="all">Ï†ÑÏ≤¥</button>
                <button class="filter-btn" data-category="ÎÆ§ÏßÄÏª¨">ÎÆ§ÏßÄÏª¨</button>
                <button class="filter-btn" data-category="Ïó∞Í∑π">Ïó∞Í∑π</button>
                <button class="filter-btn" data-category="ÌÅ¥ÎûòÏãù">ÌÅ¥ÎûòÏãù</button>
            </div>

            <!-- Posts Grid -->
            <div class="posts-grid" id="posts-grid">
                <!-- Posts will be dynamically loaded here -->
            </div>

            <div class="no-posts" id="no-posts" style="display: none;">
                Ìï¥Îãπ Ïπ¥ÌÖåÍ≥†Î¶¨Ïùò Í≥µÏó∞Ïù¥ ÏóÜÏäµÎãàÎã§.
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3 class="footer-title">StageX</h3>
                    <nav class="footer-nav">
                        <a href="#" class="footer-link">About Us</a>
                        <a href="#" class="footer-link">Our Story</a>
                        <a href="#" class="footer-link">Careers</a>
                    </nav>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Support</h3>
                    <nav class="footer-nav">
                        <a href="#" class="footer-link">Contact Us</a>
                        <a href="#" class="footer-link">Help Center</a>
                    </nav>
                </div>
                
                <div class="footer-section">
                    <h3 class="footer-title">Legal</h3>
                    <nav class="footer-nav">
                        <a href="#" class="footer-link">Privacy Policy</a>
                        <a href="#" class="footer-link">Terms of Service</a>
                    </nav>
                </div>

                <div class="footer-section footer-social">
                    <div class="social-links">
                        <a href="#" class="social-link" aria-label="Facebook">üìò</a>
                        <a href="#" class="social-link" aria-label="Twitter">üê¶</a>
                        <a href="#" class="social-link" aria-label="Instagram">üì∑</a>
                    </div>
                </div>
            </div>
        </div>
    </footer>

    <script>
        // Ìè¨Ïä§Ìä∏ Î™©Î°ù ÌéòÏù¥ÏßÄ JavaScript
        class PostsList {
            constructor() {
                this.posts = [];
                this.currentCategory = 'all';
                this.init();
            }

            async init() {
                await this.loadPosts();
                this.renderPosts();
                this.setupFilterButtons();
            }

            // Markdown ÌååÏùºÏóêÏÑú frontmatter Ï∂îÏ∂ú
            parseFrontmatter(content) {
                const frontmatterRegex = /^---\n([\s\S]*?)\n---/;
                const match = content.match(frontmatterRegex);
                
                if (!match) return null;
                
                const frontmatter = {};
                const lines = match[1].split('\n');
                
                lines.forEach(line => {
                    const colonIndex = line.indexOf(':');
                    if (colonIndex === -1) return;
                    
                    const key = line.substring(0, colonIndex).trim();
                    let value = line.substring(colonIndex + 1).trim();
                    
                    // Îî∞Ïò¥Ìëú Ï†úÍ±∞
                    value = value.replace(/^["']|["']$/g, '');
                    
                    // Î∞∞Ïó¥ Ï≤òÎ¶¨
                    if (value.startsWith('[') && value.endsWith(']')) {
                        value = JSON.parse(value);
                    }
                    
                    frontmatter[key] = value;
                });
                
                return frontmatter;
            }

            // Ìè¨Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
            async loadPosts() {
                try {
                    const filesResponse = await fetch('data/files.json');
                    const filesData = await filesResponse.json();
                    const postFiles = filesData.posts || [];
                    
                    this.posts = await Promise.all(
                        postFiles.map(async (filename) => {
                            try {
                                const response = await fetch(`posts/${filename}`);
                                const content = await response.text();
                                const frontmatter = this.parseFrontmatter(content);
                                
                                if (!frontmatter) return null;
                                
                                const id = filename.replace('.md', '');
                                
                                return {
                                    id,
                                    title: frontmatter.title,
                                    date: frontmatter.date,
                                    category: frontmatter.category,
                                    image: frontmatter.image,
                                    venue: frontmatter.venue,
                                    period: frontmatter.period,
                                    excerpt: frontmatter.excerpt,
                                    tags: frontmatter.tags
                                };
                            } catch (error) {
                                console.error(`Error loading ${filename}:`, error);
                                return null;
                            }
                        })
                    );
                    
                    this.posts = this.posts
                        .filter(post => post !== null)
                        .sort((a, b) => new Date(b.date) - new Date(a.date));
                    
                } catch (error) {
                    console.error('Ìè¨Ïä§Ìä∏ Îç∞Ïù¥ÌÑ∞Î•º Î∂àÎü¨Ïò§Îäî Ï§ë Ïò§Î•òÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§:', error);
                    this.posts = [];
                }
            }

            // Ìè¨Ïä§Ìä∏ Î†åÎçîÎßÅ
            renderPosts() {
                const postsGrid = document.getElementById('posts-grid');
                const noPosts = document.getElementById('no-posts');
                
                if (!postsGrid) return;

                // Ïπ¥ÌÖåÍ≥†Î¶¨ ÌïÑÌÑ∞ÎßÅ
                const filteredPosts = this.currentCategory === 'all' 
                    ? this.posts 
                    : this.posts.filter(post => post.category === this.currentCategory);

                if (filteredPosts.length === 0) {
                    postsGrid.style.display = 'none';
                    noPosts.style.display = 'block';
                    return;
                }

                postsGrid.style.display = 'grid';
                noPosts.style.display = 'none';

                postsGrid.innerHTML = filteredPosts.map(post => `
                    <article class="post-card" data-post-id="${post.id}">
                        <div class="post-card-image">
                            <img src="${post.image}" alt="${post.title}" loading="lazy" onerror="this.src='images/placeholder.jpg'">
                        </div>
                        <div class="post-card-content">
                            <span class="post-card-category">${post.category}</span>
                            <h3 class="post-card-title">${post.title}</h3>
                            <p class="post-card-excerpt">${post.excerpt}</p>
                            <div class="post-card-meta">
                                <span class="post-card-date">${this.formatDate(post.date)}</span>
                                <span class="post-card-venue">${post.venue}</span>
                            </div>
                        </div>
                    </article>
                `).join('');

                // ÌÅ¥Î¶≠ Ïù¥Î≤§Ìä∏ Ï∂îÍ∞Ä
                postsGrid.querySelectorAll('.post-card').forEach(card => {
                    card.addEventListener('click', () => {
                        const postId = card.dataset.postId;
                        window.location.href = `post.html?id=${postId}`;
                    });
                });
            }

            // ÌïÑÌÑ∞ Î≤ÑÌäº ÏÑ§Ï†ï
            setupFilterButtons() {
                const filterButtons = document.querySelectorAll('.filter-btn');
                
                filterButtons.forEach(btn => {
                    btn.addEventListener('click', () => {
                        // ÌôúÏÑ± Î≤ÑÌäº Î≥ÄÍ≤Ω
                        filterButtons.forEach(b => b.classList.remove('active'));
                        btn.classList.add('active');
                        
                        // Ïπ¥ÌÖåÍ≥†Î¶¨ Î≥ÄÍ≤Ω Î∞è Ïû¨Î†åÎçîÎßÅ
                        this.currentCategory = btn.dataset.category;
                        this.renderPosts();
                    });
                });
            }

            // ÎÇ†Ïßú Ìè¨Îß∑ÌåÖ
            formatDate(dateString) {
                const date = new Date(dateString);
                const options = { year: 'numeric', month: 'long', day: 'numeric' };
                return date.toLocaleDateString('ko-KR', options);
            }
        }

        // ÌéòÏù¥ÏßÄ Î°úÎìú Ïãú Ï¥àÍ∏∞Ìôî
        document.addEventListener('DOMContentLoaded', () => {
            const postsList = new PostsList();
        });
    </script>
</body>
</html>

